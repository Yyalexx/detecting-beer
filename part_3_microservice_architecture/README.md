 **Микросервисная архитектура** составлена из 3-х сервисов:  
 - **images**  
 - **model**
 - **dataframe**  

     Сервис **images** принимает на вход фотографии витрин экспортированные из базы 1С из папки *input_images*, производит их обработку и помещает обработанные изображения во внутреннюю папку поекта *resized_images*. ID обработанных изображений помещаются в очередь *images*. Изображение, для которого произведена обработка, удаляется из папки *input_images*.  
    Сервис **model**  принимает из очереди *images* ID изображений, считывает по ним изображения из папки *resized_images*. Модель делает предикт, который помещается в очередь *predict*, идентификатором сообщения служит ID изображения. Изображение, для которого сформирован предикт, удаляется из папки *resized_images*.  
        Сервис **dataframe** принимает из очереди *predict* ID изображения и соответствующий ему предикт. Из полученных предиктов составляется датафрейм, который записывается в файл predict_df.csv.  
Все сервисы работают в непрерывном режиме, постоянно анализируя наличие фотографий в папке *input_images* и обновляя в файл predict_df.csv.  
# Сервис **images**
Сервис **images** выполняет 2 функции.  
**Первая функция** сервиса состоит в приведении размера входных изображений к единому значению 640х640. Реализована библиотекой PIL с использованием фильтра Ланцоша. 
При сохранении изображения с помощью библиотеки PIL все метаданные exif стираются, поэтому сохраненное изображение без метаинформации уже не поворачивается при отображении, то есть непредсказуемо поворачивается. Поскольку PIL стирает метаинформацию при сохранении изображения, то при наличии тега ориентации обработанное изображение необходимо поворачивать. Это **вторая функция** сервиса **images**.
